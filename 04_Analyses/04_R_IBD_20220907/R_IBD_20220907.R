### Isolation by distance
### Alix Matthews
### 2022 Sept 7

## Running only on ld01, dp15 datasets

### R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"

### OS: Ubuntu 20.04.3 LTS


#### Set working directory and load libraries ####
setwd("~/Desktop/Alix/snp_20220730/20220907_IBD/")

library(ade4) # 1.7-19
library(reshape2) # 1.4.4
library(ggplot2) # 3.3.6
library(ggthemes) # 4.2.4
library(gridExtra) # 2.3

#### CERW IBD analyses ####

# To get this matrix... 
### open snp_20220730/pairwise_fst_matrices/cerw_dp15_ld01_pfs.pairwise.fst.jack_pcoa.csv in Excel
### copy and paste all of it to another empty Excel file
### remove the top half values, and headers on col1 and row1
### find/replace NA with 0.00000000000
### copy the rest and paste into text editor and then paste here


cerw_fst_ibd <-
  "0																													
0.11959774891624	0																												
0.160808917873561	0.129965604244288	0																											
0.093715799694033	0.05967627165319	0.105303666132498	0																										
0.076535965723257	0.043189550689941	0.085794213406741	0.020613547105165	0																									
0.0794920595214	0.044957086112822	0.089592232340934	0.020453058272782	-0.003254003389402	0																								
0.080468121784339	0.051613133287764	0.092776661312148	0.026900156704146	0.004593153333522	0.004939368407625	0																							
0.097628564429804	0.064989687793979	0.110282807837914	0.0422596961207	0.021497895554689	0.020073198429765	0.025513398564054	0																						
0.079365260359243	0.052195582158438	0.092705078626688	0.028289571935291	0.005585400816507	0.005834141045157	0.011366797240387	0.024853132338373	0																					
0.08399917498975	0.051622755490065	0.093697734203128	0.028629662240375	0.006811098683487	0.007236283445407	0.013075115625311	0.031130859053902	0.013074280099149	0																				
0.084561648274597	0.053649496660515	0.095448139351251	0.029822923639524	0.00920564063963	0.009768791351773	0.014580078385489	0.029483384082435	0.014884269187052	0.016842212292734	0																			
0.092840956237029	0.061569527811788	0.102275823172448	0.038932606765249	0.016683924376867	0.017001135084742	0.023203787587135	0.036117111369458	0.023675447588455	0.025329340322717	0.027818408090143	0																		
0.096824944665392	0.065229443453514	0.113148277752177	0.041865372399425	0.021478252307972	0.022066197979701	0.028199247438727	0.041440340399898	0.027589484630112	0.028825887533946	0.032769407230646	0.037514404570875	0																	
0.088493566740461	0.05573586055345	0.096773354952719	0.031486832673161	0.011015237165333	0.012192763943177	0.019056335271678	0.032612036149082	0.017209158806284	0.018775452876904	0.021506547930229	0.028636385787334	0.034008809796581	0																
0.115676160742107	0.085774739856423	0.122837064306694	0.058590365332519	0.039035577879565	0.040155019979839	0.046181666516176	0.0590502803036	0.046959268768825	0.046752976073043	0.047662031413354	0.053870874645371	0.061369868111001	0.050790402460703	0															
0.096113660153341	0.065064997414173	0.109310062329692	0.040432619487879	0.020386018100685	0.02103619055063	0.026052327223957	0.041430280149988	0.027119019565035	0.02790225695598	0.028544831209157	0.037535594041545	0.041263660967237	0.032318253866099	0.060653364428247	0														
0.086241608217458	0.057907806005742	0.097895875961721	0.031018859532932	0.007927200949233	0.009266673451996	0.01495032764472	0.031033016433582	0.017019173285497	0.016789005847751	0.01901848128088	0.026863284869011	0.032955620166903	0.020449383178635	0.04788005154037	0.030565635076493	0													
0.083141372586769	0.048457955115289	0.090678069522041	0.026675559221737	0.005931519101705	0.004455841603373	0.011168506182023	0.025491663153703	0.01341034022476	0.013588700868977	0.014559150763558	0.022453973337514	0.02826335869958	0.018956075032332	0.045344016769072	0.025494130182557	0.017316084886824	0												
0.083008478837784	0.051202145403573	0.09230153140411	0.028985415042406	0.007623087768521	0.007334868001296	0.012583904226769	0.02815580499561	0.013057322158724	0.012350061226662	0.016658865785914	0.024631310359316	0.028237895703288	0.018481531491401	0.045853821770115	0.026659869534205	0.015620372832802	0.011984188409726	0											
0.07923211333608	0.049429789009715	0.093059613514464	0.024957968838293	0.005261372200767	0.004199387654904	0.010536455280905	0.027024392577169	0.012162783693601	0.013379601929176	0.014768139043486	0.022157694768502	0.028122167698371	0.016182090848736	0.046200910396879	0.025738829433167	0.014874762092829	0.011598173741381	0.012472498893275	0										
0.09351033365882	0.061102350623077	0.104762719669253	0.037567550013604	0.014816432732355	0.01405558130281	0.020430715523013	0.03763229010657	0.021091067349341	0.021238105157946	0.024030843673861	0.032513288025201	0.036449707463198	0.025331207227478	0.05751825389834	0.036306504087609	0.02493716541538	0.021107933322305	0.021686873544526	0.01869863826579	0									
0.08033421189168	0.049662703161887	0.091063933875269	0.024963508568795	0.003447369218935	0.005219869628306	0.010411728931783	0.027264309122061	0.00971204611521	0.011408995139342	0.013527388995301	0.022100412719456	0.026203488026743	0.015764524113158	0.044647591696342	0.024941330383618	0.014359787829915	0.010834989681886	0.011490752971602	0.008119916615003	0.019272940030736	0								
0.08216585432962	0.050500557690122	0.096823907238172	0.028499900363136	0.006831909744233	0.005801195158526	0.012265840743826	0.028177834831168	0.012961744972939	0.013761612978989	0.015874925396478	0.024888486874246	0.02866593052399	0.017438205668436	0.046888131239511	0.026609811790926	0.016386900053438	0.012442793809601	0.012012736335057	0.01075418022105	0.021097182833592	0.011423758547514	0							
0.081827067408	0.051367920896893	0.0919011973428	0.025983810308463	0.004451318180806	0.003860077010406	0.011982118173633	0.026946388244622	0.011967183524475	0.013224705202614	0.01487607528634	0.022399633766224	0.027647460401586	0.017616984798887	0.044907626692065	0.026353500753128	0.014666200799685	0.011463409791044	0.011954014621649	0.009304429027348	0.020975503634019	0.010453268810517	0.011719751228208	0						
0.086784809599642	0.054506973742178	0.096742438556608	0.030939893178656	0.009267092207947	0.009932523038852	0.014332792455118	0.030185079618983	0.015213400839874	0.016448021181974	0.017131353936882	0.028419821835798	0.031109739001956	0.019742167281103	0.050166981631608	0.029425136528912	0.018329200227016	0.015457071580743	0.014517443609191	0.013555346303274	0.02234522750323	0.013029403795315	0.016519252044924	0.014732222870082	0					
0.087408534779962	0.054833716415451	0.096798900695294	0.030863086576957	0.009688596805355	0.010141757406259	0.01729639825913	0.033645329996825	0.016511459836467	0.017237523712908	0.020265902082036	0.028090125100632	0.033622600282418	0.020983600829636	0.049614268419435	0.031778662222186	0.020050634089288	0.016668302781044	0.017454896300402	0.015677341605948	0.025480426640217	0.015318291248455	0.017117280681131	0.016509645138414	0.020161603426561	0				
0.093946414929916	0.058620518967302	0.101136578869709	0.034072492323725	0.012935016218384	0.014379437326677	0.019265096911424	0.036030222103175	0.02188951207404	0.021608111016287	0.02324408735018	0.031872823762138	0.036390608791241	0.028021752265917	0.053629731795461	0.034270395720787	0.025465982273002	0.020485283360277	0.021844038774665	0.020996403249314	0.030279221305254	0.020536814988779	0.022687584525308	0.019707221637793	0.023061817526828	0.026426272596703	0			
0.101951660620275	0.067411379919666	0.112022467324107	0.04744481578171	0.024697109070156	0.023923920104398	0.031364339716795	0.046702249918603	0.031388437950374	0.029554274946611	0.033320678136728	0.043535719675034	0.049224748604674	0.036842599135202	0.066570403514834	0.044572607284472	0.035593232832261	0.030564057729637	0.031917572973538	0.030697600157444	0.040629713350528	0.030539885595629	0.03251983007014	0.03093990882792	0.032927905749184	0.027786560647932	0.039504985495823	0		
0.079041147412862	0.047433874087561	0.089626674683288	0.023894204964286	0.003041556234959	0.004652143757243	0.009722497059184	0.026543592226592	0.009773201673795	0.01216585833238	0.014509899295003	0.021172237620285	0.02671991397627	0.017467011342559	0.04226566168216	0.025027560647487	0.014933735301814	0.010631515442107	0.010704436543835	0.010714318743334	0.020610585457879	0.008570632337746	0.010454832936359	0.009957152396148	0.013645811756288	0.015263844598543	0.018446827006451	0.030025557631463	0	
0.083350848259714	0.050976333242724	0.096073404023125	0.028422963696061	0.007427135646932	0.008437269915158	0.013343418027164	0.028549209540866	0.014150544751631	0.015083435796574	0.01784265509604	0.025749355127845	0.031192219129246	0.018614560888426	0.04870991957808	0.029341783510819	0.017414147082588	0.014532096351972	0.014294069044526	0.013440352075676	0.021533775222865	0.013355655030082	0.013361345777304	0.013901870699528	0.014452072010986	0.01649628586945	0.023161275831599	0.031983669581199	0.01198979361546	0"

class(cerw_fst_ibd) # character

# make previous input into a matrix
mat2 <- data.matrix(read.table(text=cerw_fst_ibd, fill = TRUE, col.names=paste("V", 1:30))) # 1:30 because I have 30 groups (locations)
mat2[upper.tri(mat2)] <- t(mat2)[upper.tri(mat2)]
mat2 # view
cerw_fst_ibd <- mat2 # rename
cerw_fst_ibd

class(cerw_fst_ibd) # "matrix" "array" 

# make matrix into class dist
cerw_fst_ibd_dist<-as.dist(cerw_fst_ibd, diag=T)

cerw_fst_ibd_dist

class(cerw_fst_ibd_dist) # "dist"

# remove negative fst values and make zeros instead (negative fst is effectively zero)
cerw_fst_ibd_dist[cerw_fst_ibd_dist<0] <- 0

cerw_fst_ibd_dist

# linearize fst (fst/(1-fst))
cerw_fst_ibd_dist_linear <- cerw_fst_ibd_dist/(1-cerw_fst_ibd_dist)

cerw_fst_ibd_dist_linear

class(cerw_fst_ibd_dist_linear) # dist



# now can read in the geographic distance matrix
# read table
cerw_geo_ibd <- read.table("CERW_GDM_output.txt", header=T)

# change to class dist
cerw_geo_ibd <- as.dist(cerw_geo_ibd, diag=T)

cerw_geo_ibd

class(cerw_geo_ibd) # dist

# now run mantel test
cerw_mantel_ibd <- mantel.rtest(cerw_fst_ibd_dist_linear, cerw_geo_ibd, nrepet = 9999)
cerw_mantel_ibd # results

# Monte-Carlo test
# Call: mantelnoneuclid(m1 = m1, m2 = m2, nrepet = nrepet)
# 
# Observation: 0.1503031 
# 
# Based on 9999 replicates
# Simulated p-value: 0.0382 
# Alternative hypothesis: greater 
# 
# Std.Obs Expectation    Variance 
# 1.734174934 0.001573771 0.007355420 

plot(cerw_mantel_ibd) # histogram with permutations

# scatter plot with abline
plot(cerw_fst_ibd_dist_linear~cerw_geo_ibd)
abline(lm(cerw_fst_ibd_dist_linear~cerw_geo_ibd), col="red")

# plot final
Corner_text <- function(text, location="topright"){
  legend(location,legend=text, bty ="n", pch=NA)
}
plot(cerw_geo_ibd, cerw_fst_ibd_dist_linear,
     main = "A. ischyros Isolation-by-distance",
     ylab = "Fst/(1-Fst)",
     xlab = "Geographic distance (km)",
     pch=20)
Corner_text(text="R2 = 0.15; p = 0.038")
abline(lm(cerw_fst_ibd_dist_linear~cerw_geo_ibd), col="red")



cerw_fst_ibd_melt<- melt(as.matrix(cerw_fst_ibd_dist_linear), varnames=c("row", "col"))
cerw_geo_ibd_melt <- melt(as.matrix(cerw_geo_ibd), varnames=c("row", "col"))
cerw_ibd_geo_melt <- data.frame(cerw_fst_ibd_melt, cerw_geo_ibd_melt)
head(cerw_ibd_geo_melt)



cerw_ibd_plot <- 
  ggplot(cerw_ibd_geo_melt, aes(x=value.1, y=value)) +
  geom_point(col = "gray40") +
  stat_smooth(method=lm, formula = y~x, colour = "cadetblue4", fill = "cadetblue3") +
  xlab("Geographic distance (km)") +
  ylab("Fst/(1-Fst)") +
  theme_classic() +
  xlim(-1,1500) +
  theme(axis.title = element_text(size = 16)) +
  theme(axis.text = element_text(size=16)) +
  annotate("text", x=1100, y = 0.18, label = "paste(italic(R)^2, \" = 0.15, p = 0.038\")", size = 6, col = "cadetblue4", parse = TRUE)

cerw_ibd_plot

# save as 6 x 7  landscape




















#### PROW IBD analyses ####


# To get this matrix... 
### open snp_20220730/pairwise_fst_matrices/prow_dp15_ld01_pfs.pairwise.fst.jack_pcoa.csv in Excel
### copy and paste all of it to another empty Excel file
### remove the top half values, and headers on col1 and row1
### find/replace NA with 0.00000000000
### copy the rest and paste into text editor and then paste here



prow_fst_ibd <-
  "0																										
0.051065933576098	0																									
0.025412951170781	0.047738016606935	0																								
0.048489440394507	0.072128435775469	0.043030457078579	0																							
0.027675856095033	0.046064328448724	0.021958385144201	0.044214680554566	0																						
0.034382175743048	0.053358644906349	0.030276667200503	0.051278139143694	0.029111123326997	0																					
0.026366822831369	0.045262877993581	0.022149152968927	0.044320891508117	0.021287704741537	0.028055091325529	0																				
0.030288605140559	0.049155693081136	0.021387503178436	0.046464606566285	0.025304123839804	0.032677955112161	0.02397381546883	0																			
0.024039213847687	0.043915783245987	0.01681164408632	0.040901834857191	0.016699326525233	0.023937934701447	0.015576070379403	0.024312201618705	0																		
0.036639730685774	0.056369662013327	0.031635310344232	0.053212133786605	0.029976463739171	0.037803980652331	0.031284788398977	0.035353287527855	0.026840364306758	0																	
0.047140561736508	0.069896123752346	0.042721562707524	0.063088321847539	0.044745045418577	0.050170961257373	0.04128044588849	0.045396830119461	0.041295877263222	0.052440423643755	0																
0.063097377477839	0.083881106540197	0.059685360057712	0.081226545984272	0.062753266345731	0.066726258527527	0.052513074609433	0.062614347696743	0.056971060230972	0.068457412533648	0.081065207874007	0															
0.07184957689748	0.087666214497081	0.067325225455218	0.086664726693149	0.063826559907425	0.07046396250463	0.066180989431045	0.066742665004543	0.05721432664678	0.073869007391652	0.083909521355749	0.104658112158246	0														
0.134178310056365	0.152119395028903	0.124979762100011	0.154992629221951	0.129391323793184	0.137066084875491	0.127303436852785	0.128481552142281	0.122445544432389	0.136977693217796	0.146909393129307	0.168265084912919	0.174045397611757	0													
0.05646372115511	0.077059822794572	0.052112273696727	0.074864322088126	0.052256397486662	0.058605993137809	0.050598732348963	0.055419670494483	0.047110375400859	0.0595850358394	0.075229705466037	0.090581930448032	0.09657138402909	0.159319827938035	0												
0.037744701897909	0.056314030953701	0.03414119265888	0.054732038758838	0.029962286558199	0.038661935046407	0.029027741625406	0.034670016721501	0.026919667293703	0.0410098035582	0.053558137092044	0.07131707119759	0.069307643920993	0.138167002931412	0.061240809133461	0											
0.066615475571186	0.084403116950524	0.060940409991115	0.081237333533925	0.063102072281457	0.070236669014267	0.058137216540734	0.063467561664767	0.056505533883287	0.06719322478459	0.079195249039648	0.099456528638673	0.102109610388314	0.166835433088915	0.09100740785081	0.069410879311088	0										
0.050953618549937	0.072135785881198	0.046331268794232	0.065967534878087	0.047746431496076	0.055665267358688	0.044795532936798	0.047943195965722	0.046425033118986	0.057614065909274	0.068824487434957	0.08853873299553	0.094500893702479	0.154687105090038	0.077399167239924	0.058127148119899	0.084910625425732	0									
0.040249561672659	0.059720848327843	0.038389578338119	0.059171563562401	0.036766132397085	0.044767335546155	0.035060578790364	0.03802891784943	0.033249951623849	0.046556036873074	0.060083601656873	0.075549601211058	0.081087472676993	0.138348589847725	0.06786859031496	0.047169905602544	0.075606900454057	0.060436666243044	0								
0.039552079183038	0.058482875810964	0.03617313776038	0.057041513344003	0.035496058595064	0.042795067018173	0.033230889963679	0.03668347766919	0.03339612379913	0.044384108276544	0.05651948060075	0.072205740384943	0.079343754981095	0.13817562746587	0.063102804385012	0.04666040183115	0.075421288018421	0.06364027090645	0.04891613589188	0							
0.035330401545436	0.053364403621927	0.03077482912417	0.050454682900584	0.030403079601747	0.038039796129272	0.029507383667708	0.034724953559153	0.027632776924416	0.039975770379014	0.053266575921916	0.066603731730603	0.073178240546864	0.135993894004376	0.059340509843902	0.040819564712243	0.067876119314979	0.057356990563577	0.04475981882127	0.038001416014815	0						
0.027651876717048	0.048037990005804	0.02186086466803	0.043082073095975	0.023934738755369	0.029780707143459	0.020650846717952	0.024858966159386	0.019583160184869	0.033783831331335	0.045617743914879	0.058823700362738	0.06750054384664	0.126999768166702	0.053776702953269	0.032671907682544	0.058735636261644	0.04883218383878	0.037089188736163	0.036307665667495	0.029432420314521	0					
0.027664600510669	0.047030147336887	0.025002966898123	0.045449118123698	0.024818037233284	0.033219924121798	0.021909343046885	0.023846924568054	0.021131250892717	0.03496840873987	0.045564639483289	0.062293254892777	0.066042412216391	0.130669068344702	0.050963043317383	0.03426638683307	0.058989637595779	0.048327067404531	0.037769625261557	0.038127087705096	0.032933181473784	0.025799812853023	0				
0.044091143450248	0.061477845589858	0.037916308642278	0.060169937141314	0.038042991670479	0.044129858087121	0.036205704981967	0.046221309264809	0.032067247665475	0.047505026302058	0.060387505935753	0.076823468721671	0.077803923505015	0.143830746801211	0.06854174097445	0.04413157349299	0.075569463398466	0.064389036091541	0.053092940817487	0.052519431844633	0.043562918390236	0.03933418475222	0.040358560933979	0			
0.103131659090527	0.12341000727422	0.097865638010738	0.119234766121712	0.09713714719989	0.10649654839618	0.095981411099895	0.100499339507208	0.096089042620069	0.109187622241134	0.121459430017041	0.140223427514563	0.14397323428563	0.204841542127525	0.127073377041574	0.110265515022486	0.138995675427985	0.129496850711095	0.113736987166893	0.108466473507833	0.104177311310287	0.10032680619923	0.098006436761074	0.115397724641445	0		
0.051174629768532	0.070797582260637	0.046793997200414	0.070247024025324	0.046623089481127	0.051568174973756	0.04575176724377	0.049394602037056	0.039643158513363	0.056105746313815	0.067885447461182	0.082817174200269	0.09141531413015	0.156697623230225	0.076865665109392	0.053724719368061	0.086337400769352	0.073202995728335	0.06296445044568	0.060711293363743	0.053854027564576	0.048484216444936	0.049069498578138	0.058651122229672	0.126492801731417	0	
0.048813314982853	0.067775740717174	0.042872849483552	0.064118067483461	0.042568484108423	0.052342561523306	0.042363525294058	0.048638688186296	0.039710301205892	0.051495642406417	0.066431591738386	0.083284985771436	0.086287888328642	0.150009801520273	0.078333218365201	0.052638434021806	0.083728719248573	0.071618165017477	0.059221902540535	0.05731414709663	0.050299492405336	0.045841808919699	0.046420663108584	0.058266247948084	0.117322986633697	0.067735713044185	0
"


class(prow_fst_ibd) # character

# make previous input into a matrix
mat2 <- data.matrix(read.table(text=prow_fst_ibd, fill = TRUE, col.names=paste("V", 1:27))) # 1:27 because I have 27 groups (locations)
mat2[upper.tri(mat2)] <- t(mat2)[upper.tri(mat2)]
mat2 # view
prow_fst_ibd <- mat2 # rename
prow_fst_ibd

class(prow_fst_ibd) # "matrix" "array" 

# make matrix into class dist
prow_fst_ibd_dist<-as.dist(prow_fst_ibd, diag=T)

prow_fst_ibd_dist

class(prow_fst_ibd_dist) # "dist"

# remove negative fst values and make zeros instead (negative fst is effectively zero)
prow_fst_ibd_dist[prow_fst_ibd_dist<0] <- 0

prow_fst_ibd_dist

# linearize fst (fst/(1-fst))
prow_fst_ibd_dist_linear <- prow_fst_ibd_dist/(1-prow_fst_ibd_dist)

prow_fst_ibd_dist_linear

class(prow_fst_ibd_dist_linear) # dist



# now can read in the geographic distance matrix
# read table
prow_geo_ibd <- read.table("PROW_GDM_output.txt", header=T)

# change to class dist
prow_geo_ibd <- as.dist(prow_geo_ibd, diag=T)

prow_geo_ibd

class(prow_geo_ibd) # dist

# now run mantel test
prow_mantel_ibd <- mantel.rtest(prow_fst_ibd_dist_linear, prow_geo_ibd, nrepet = 9999)
prow_mantel_ibd # results

# Monte-Carlo test
# Call: mantelnoneuclid(m1 = m1, m2 = m2, nrepet = nrepet)
# 
# Observation: -0.1285197 
# 
# Based on 9999 replicates
# Simulated p-value: 0.9781 
# Alternative hypothesis: greater 
# 
# Std.Obs   Expectation      Variance 
# -2.1987934964 -0.0003733631  0.0033965935 

plot(prow_mantel_ibd) # histogram with permutations

# scatter plot with abline
plot(prow_fst_ibd_dist_linear~prow_geo_ibd)
abline(lm(prow_fst_ibd_dist_linear~prow_geo_ibd), col="red")

# plot final
Corner_text <- function(text, location="topright"){
  legend(location,legend=text, bty ="n", pch=NA)
}
plot(prow_geo_ibd, prow_fst_ibd_dist_linear,
     main = "A. protonotaria Isolation-by-distance",
     ylab = "Fst/(1-Fst)",
     xlab = "Geographic distance (km)",
     pch=20)
Corner_text(text="R2 = -0.13; p = 0.98")
abline(lm(prow_fst_ibd_dist_linear~prow_geo_ibd), col="red")



prow_fst_ibd_melt<- melt(as.matrix(prow_fst_ibd_dist_linear), varnames=c("row", "col"))
prow_geo_ibd_melt <- melt(as.matrix(prow_geo_ibd), varnames=c("row", "col"))
prow_ibd_geo_melt <- data.frame(prow_fst_ibd_melt, prow_geo_ibd_melt)
head(prow_ibd_geo_melt)



prow_ibd_plot <- 
  ggplot(prow_ibd_geo_melt, aes(x=value.1, y=value)) +
  geom_point(col = "gray40") +
  stat_smooth(method=lm, formula = y~x, colour = "darkgoldenrod4", fill = "darkgoldenrod3") +
  xlab("Geographic distance (km)") +
  ylab("Fst/(1-Fst)") +
  theme_classic() +
  xlim(-1,1500) +
  theme(axis.title = element_text(size = 16)) +
  theme(axis.text = element_text(size=16)) +
  annotate("text", x=1100, y = 0.24, label = "paste(italic(R)^2, \" = -0.12, p = 0.978\")", size = 6, col = "darkgoldenrod4", parse = TRUE)


prow_ibd_plot

# save as 6 x 7  landscape











#### put figures together ####


pdf("CERW_PROW_IBD.pdf", width=7, height=14)
grid.arrange(cerw_ibd_plot, prow_ibd_plot,
             nrow = 2)
dev.off()


#### ++++++ TIFF format  - only if needed, but this is a huge file ####
# dpi=800 #pixels per square inch
# tiff("CERW_PROW_IBD.tif", width=7*dpi, height=14*dpi, res=dpi)
# grid.arrange(cerw_ibd_plot, prow_ibd_plot,
#              nrow = 2)
# dev.off()
